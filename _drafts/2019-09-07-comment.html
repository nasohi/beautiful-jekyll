---
layout: post
title: How to Configure IKEV2 VPN with PowerShell
date: '2019-09-07T22:26:00.000+07:00'
author: Nasohi Ciptandani
tags: 
modified_time: '2019-09-07T22:26:57.369+07:00'
blogger_id: tag:blogger.com,1999:blog-7821506235811301823.post-3265451606993123341
blogger_orig_url: https://www.blogger.com/comment.g?blogID=7821506235811301823&postID=3265451606993123341
---

In this tutorial will be guide you to configure IKEV2 VPN with Powershell step by step:<br /><br />Server OS: Windows Server 2019<br /><br />Client OS: Windows 10<br /><br />VPN Protocol: IKEV2<br /><br />VPN Auth protocol: Certificate, EAP&nbsp;<a href="https://docs.microsoft.com/en-us/powershell/module/remoteaccess/set-vpnauthprotocol?view=winserver2012-ps">https://docs.microsoft.com/en-us/powershell/module/remoteaccess/set-vpnauthprotocol?view=winserver2012-ps</a><br /><br />VPN Auth type: Windows Username &amp; Password&nbsp;<a href="https://docs.microsoft.com/en-us/powershell/module/remoteaccess/set-vpnauthtype?view=winserver2012-ps">https://docs.microsoft.com/en-us/powershell/module/remoteaccess/set-vpnauthtype?view=winserver2012-ps</a><br /><br /><b>1. Install VPN software on the server</b><br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Install-WindowsFeature RemoteAccess</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Install-WindowsFeature RSAT-RemoteAccess-PowerShell</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Install-WindowsFeature Routing</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Install-RemoteAccess -VpnType Vpn</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: inherit;"><b>2. Configure VPN</b></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">$VPNRootCertAuthority = “Common Name of trusted root certification authority”</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">$RootCACert = (Get-ChildItem -Path cert:LocalMachine\root | Where-Object {$_.Subject -Like “*$VPNRootCertAuthority*” })</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Set-VpnAuthProtocol -UserAuthProtocolAccepted Certificate, EAP -RootCertificateNameToAccept $RootCACert -PassThru</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span>