---
layout: post
title: How to configure HTTPS in IIS Windows Server via PowerShell
date: '2019-09-17T23:44:00.003+07:00'
author: Nasohi Ciptandani
tags:
- ITNSA
- Windows
modified_time: '2019-09-18T00:01:57.804+07:00'
blogger_id: tag:blogger.com,1999:blog-7821506235811301823.post-3161015841201342430
blogger_orig_url: https://nciptandani.blogspot.com/2019/09/cara-konfigurasi-https-di-iis-windows.html
---

<div>Cara konfigurasi HTTPS di IIS Windows Server melalui PowerShell<br /><br />Untuk konfigurasi HTTP melalui PowerShell bisa baca disini&nbsp;<a href="https://nciptandani.blogspot.com/2019/06/cara-konfigurasi-web-server-iis-di.html">https://nciptandani.blogspot.com/2019/06/cara-konfigurasi-web-server-iis-di.html</a></div><div><br /></div><div>Untuk membuat server CA dan webserver sertifikat template</div><div><a href="https://nciptandani.blogspot.com/2018/08/pembahasan-itnsa-module-b-windows-ca.html">https://nciptandani.blogspot.com/2018/08/pembahasan-itnsa-module-b-windows-ca.html</a></div><div><br /></div><div>Kemudian dari webserver sertifikat template tersebut bisa digunakan untuk membuat sertifikat, bisa melalui MMC -&gt; Certificates -&gt; Local computar -&gt; Personal -&gt; klik kanan ceritificates -&gt; All tasks -&gt;&nbsp; request new certificate -&gt; next -&gt; pilih webserver template yang sudah dibuat -&gt; kemudian isi informasi seperti common name, subject alternative name dengan benar.</div><div><br /></div>Sertifikat yang akan dipasang dengan format PFX, file sertifikat PFX ini bisa didapatkan dari server CA. Cara export PFX dari windows server CA&nbsp;<a href="https://www.youtube.com/watch?v=m157RGX6S1g">https://www.youtube.com/watch?v=m157RGX6S1g</a><br /><div><br /></div><div>Kemudian import sertifikat tersebut ke server IIS</div><div><br /></div><div><div># buat varibel password untuk menyimpan password dari file sertifikat PFX</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt; <b>$Password = ConvertTo-SecureString -AsPlainText -Force "P@ssw0rd"</b></span><b>&nbsp;</b></div><div><br /></div><div># import ke [Cert:\LocalMachine\My]</div><div># pada GUI bias dicek melalui MMC -&gt; [Certificates - Local Computer] - [Personal]</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt; <b>Import-PfxCertificate -FilePath C:\Users\Administrator\window.id.pfx -CertStoreLocation Cert:\LocalMachine\My -Password $Password</b></span><b>&nbsp;</b></div></div><div><b><br /></b></div><div>Untuk melihat sertifikat yang terimport</div><div><br /><b><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Get-ChildItem Cert:\LocalMachine\My&nbsp;</span></b></div><div><br /></div><div>Setelah sertifikat berhasil diimport di server IIS maka selanjutnya akan konfigurasi IIS untuk menggunakan sertifikat tersebut.</div><div><br /></div><div><div># konfirmasi sertifikat</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt;<b> Get-ChildItem Cert:\LocalMachine\My&nbsp;</b></span></div><div><br /></div><div>&nbsp; &nbsp;PSParentPath: Microsoft.PowerShell.Security\Certificate::LocalMachine\My</div><div><br /></div><div>Thumbprint&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Subject</div><div>----------&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -------</div><div>228940060FF922175C2F435A135FD1CB26FC3A84&nbsp; CN=<b>window.id</b></div><div><br /></div><div># menampung sertifikat di sebuah variabel $Cert</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt;<b> $Cert = Get-ChildItem&nbsp;</b></span></div><div><br /></div><div>Cert:\LocalMachine\My\228940060FF922175C2F435A135FD1CB26FC3A84&nbsp;</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt; <b>Get-Website&nbsp;</b></span></div><div><br /></div><div>Name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ID&nbsp; &nbsp;State&nbsp; &nbsp; &nbsp; Physical Path&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bindings</div><div>----&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--&nbsp; &nbsp;-----&nbsp; &nbsp; &nbsp; -------------&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --------</div><div>Default Web Site 1&nbsp; &nbsp; Started&nbsp; &nbsp; %SystemDrive%\inetpub\wwwroot&nbsp; http *:80:</div><div><b>window.id</b>&nbsp; &nbsp;2&nbsp; &nbsp; Started&nbsp; &nbsp; C:\inetpub\wwwroot\newsite&nbsp; &nbsp; &nbsp;http *:80:<b>window.id</b></div><div><br /></div><div># set SSL Binding to [window.id] site</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt;<b> New-WebBinding -Name "window.id" -IPAddress "*" -HostHeader "window.id" -Port 443 -Protocol https&nbsp;</b></span></div><div><br /></div><div># set $Cert to SSL Binding</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt;<b> New-Item IIS:\SslBindings\0.0.0.0!443!window.id -Value $Cert&nbsp;</b></span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b><br /></b></span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt;<b> Get-Website&nbsp;</b></span></div><div><br /></div><div>Name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ID&nbsp; &nbsp;State&nbsp; &nbsp; &nbsp; Physical Path&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bindings</div><div>----&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--&nbsp; &nbsp;-----&nbsp; &nbsp; &nbsp; -------------&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --------</div><div>Default Web Site 1&nbsp; &nbsp; Started&nbsp; &nbsp; %SystemDrive%\inetpub\wwwroot&nbsp; http *:80:</div><div><b>window.id</b>&nbsp; &nbsp;2&nbsp; &nbsp; Started&nbsp; &nbsp; C:\inetpub\wwwroot\window&nbsp; &nbsp; &nbsp;http *:80:<b>window.id</b></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; https *:443:<b>window.id</b> sslFlags=0</div><div># verifikasi akses</div><div># jika self signed certificate, tambahkan opsi [-k] (--insecure)&nbsp;</div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">PS C:\Users\Administrator&gt;<b> curl.exe https://window.id</b></span></div></div><div><br /></div><div><br /></div><div><br /></div>