---
layout: post
title: How to backup and restore PostgreSQL databases with crontab
date: '2019-09-03T22:16:00.004+07:00'
author: Nasohi Ciptandani
tags:
- PostgreSQL
modified_time: '2019-09-03T23:02:51.631+07:00'
blogger_id: tag:blogger.com,1999:blog-7821506235811301823.post-4060216613263837535
blogger_orig_url: https://nciptandani.blogspot.com/2019/09/how-to-backup-and-restore-postgresql.html
---

<span style="font-family: inherit;">OS: Centos7</span><br /><span style="font-family: inherit;">Database server: PostgreSQL 9</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Install database server, membuat user dan databasenya</span><br /><span style="font-family: inherit;"><a href="https://nciptandani.blogspot.com/2019/01/rangkuman-install-database-postgresql.html">https://nciptandani.blogspot.com/2019/01/rangkuman-install-database-postgresql.html</a></span><br /><br /> <span style="font-family: inherit;">Berikut adalah script untuk melakukan backup</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">pg_dump -U db_user -h ip_address -F t db_name &gt; /path/to/your/file/dump_name.tar</span><br /><div><br /></div><div><div>-U = untuk user apa yang akan konek ke database</div><div>-F = untuk format file</div><div>p – plain-text SQL script</div><div>c – custom-format archive</div><div>d – directory-format archive</div><div>t – tar-format archive</div></div><div><br />Sekedar contoh database dibackup misalnya setiap menit:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>pg_dump</b> -U dev10 -h 10.148.0.6 -F -t&nbsp; dev10db &gt; /backup/dev10db.$(date +%Y-%b-%d-%H-%).tar</span><br /><br />Hasil nama file backup<br /><br />dev10db.2019-Sep-03-15-10-03.sql (file pada tanggal 3 september 2019 pada jam 15 menit 10 dan detik ke 3<br /><br />Simpan password postgresql server di file<br /><br /><span style="font-family: Courier New, Courier, monospace;">vi ~/.pgpass</span><br /><span style="font-family: Courier New, Courier, monospace;">*:5432:*:username:password</span><br /><span style="font-family: Courier New, Courier, monospace;">chmod 0600 ~/.pgpass</span><br /><br />Kemudian akan membuat crontab nya<br /><br /><br />masuk ke crontab file<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">vi /etc/crontab</span><br /><br />kemudian tambahkan berikut<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">* * * * * root /bin/</span><b style="font-family: &quot;courier new&quot;, courier, monospace;">pg_dump</b><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">&nbsp;</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">-U dev10 -h 10.148.0.6 -W -F -t&nbsp; dev10db &gt; /backup/dev10db.$(date +%Y-%b-%d-%H-%).tar</span><br /><br />Simpan file dan restart crond<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">systemctl restart crond</span><br /><br />Liat crontab dengan <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">crontab -l</span><br /><br />Cek hasil file backup di /backup/</div><div><br /></div><div><br /></div><div><br /></div>