---
layout: post
title: Make sure that firewall operates in stateful mode
date: '2018-09-17T14:29:00.000+07:00'
author: Nasohi Ciptandani
tags:
- IPTables
modified_time: '2018-09-17T15:41:40.665+07:00'
blogger_id: tag:blogger.com,1999:blog-7821506235811301823.post-8383518249064636388
blogger_orig_url: https://nciptandani.blogspot.com/2018/09/make-sure-that-firewall-operates-in.html
---

Work task:&nbsp;Make sure that firewall operates in stateful mode using iptables<br /><div><br /></div><div>Workaround:</div><div><br /></div><div><div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -P INPUT DROP</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -P FORWARD DROP</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -P OUTPUT DROP</span></div></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span></div></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span></div><div><span style="font-family: inherit;">Letakkan rule dibagian paling atas, karena iptables akan membaca rule secara berurutan, setelah rule-rule iptables diatas, selanjutnya tinggal allow service-service yang ingin digunakan, misalnya:</span></div><div><span style="font-family: inherit;"><br /></span></div><div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"># Allow remote ssh and http access</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A INPUT -p tcp --dport 22 -j ACCEPT # ssh</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A INPUT -p tcp --dport 80 -j ACCEPT # http</span></div><div><br /></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"># Allow DNS lookups to be initiated from this server</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A OUTPUT -p udp --dport 53 -j ACCEPT # dns</span></div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT # dns</span></div></div>