---
layout: post
title: Microsoft Active Directory Certificate Services CA Web Enrollment
date: '2019-05-31T22:20:00.003+07:00'
author: Nasohi Ciptandani
tags:
- ITNSA
- CA
modified_time: '2019-06-01T10:41:28.961+07:00'
thumbnail: https://1.bp.blogspot.com/-aLePoD3ZP6w/XPEOncmsq0I/AAAAAAAABYQ/YTCYLpEgV5AH5_oxW2QqhrR_OUlhkoS5QCLcBGAs/s72-c/web%2Benrollment.png
blogger_id: tag:blogger.com,1999:blog-7821506235811301823.post-5397385778984759744
blogger_orig_url: https://nciptandani.blogspot.com/2019/05/microsoft-active-directory-certificate.html
---

Ada beberapa software Public Key Infrastructure CA seperti OpenSSL, EJBCA, GnuTLS dll. Untuk provider ada digicert, comodo, let's encrypt, dll. Kali ini akan mencoba menggunakan&nbsp;Microsoft Active Directory Certificate Services dengan fitur web enrollment. Selain melalui script, command, MMC certificate. Web enrollment merupakan salah satu yang bisa digunakan mendownload CA, melakukan request dan sign sertifikat, dll.<br /><br />Contoh:<br />- Certificates signed by ADCS<br />Pertama install ADCS Certificat Authority dan Web enrollment melalui server manager.<br />Setelah terinstall, konfigurasi CA melalui server manager juga, kemudian untuk web enrollment bisa di akses melalui URL&nbsp;<a href="http://192.168.1.90/certsrv/">http://192.168.1.90/certsrv/</a>&nbsp;sesuikan dengan IP anda.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-aLePoD3ZP6w/XPEOncmsq0I/AAAAAAAABYQ/YTCYLpEgV5AH5_oxW2QqhrR_OUlhkoS5QCLcBGAs/s1600/web%2Benrollment.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="323" data-original-width="891" height="145" src="https://1.bp.blogspot.com/-aLePoD3ZP6w/XPEOncmsq0I/AAAAAAAABYQ/YTCYLpEgV5AH5_oxW2QqhrR_OUlhkoS5QCLcBGAs/s400/web%2Benrollment.png" width="400" /></a></div><br /><br />Download CA<br />CA ini yang biasanya di install di sistem atau browser agar tidak muncul sertifikat warning saat mengakses service seperti WWW, MAIL, FTP, VPN, dll.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-poVfOhqK3Ec/XPEQJ2EvbtI/AAAAAAAABYc/6XYvA27N9QMF8wqqHFvfmfgsCvb2k7L5QCLcBGAs/s1600/2019-05-31%2B18_24_12-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="184" data-original-width="724" height="101" src="https://1.bp.blogspot.com/-poVfOhqK3Ec/XPEQJ2EvbtI/AAAAAAAABYc/6XYvA27N9QMF8wqqHFvfmfgsCvb2k7L5QCLcBGAs/s400/2019-05-31%2B18_24_12-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" width="400" /></a></div><div style="text-align: center;">Gambar Download CA</div><div style="text-align: center;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Untuk membuat sertifikat melalui web enrollment perlu membuat terlebih dahulu CSR.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Untuk membuat CSR bisa menggunakan OpenSSL, perintah openssl ini hanya untuk membuat CSR dan Key, untuk sertifikat nya akan di sign oleh ADCS.</div><div style="text-align: left;"><br /></div><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">openssl req -new -newkey rsa:2048 -nodes&nbsp;</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">-sha256</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">&nbsp;-keyout myweb.key -out myweb.csr</span><br /><br /><div style="text-align: left;"><span style="font-family: inherit;">Note:&nbsp;</span>Google Chrome has deprecated the use of the Common Name field of an SSL certificate.<br />Gunakan config .cnf seperti berikut<br /><br />isi file myconfig.cnf, sesuikan dengan kebutuhan anda<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">[req]</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">distinguished_name = req_distinguished_name</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">req_extensions = v3_req</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">prompt = no</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">[req_distinguished_name]</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">C = ID</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">ST = SomeProvince</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">L = SomeCity</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">O = MyCompany</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">OU = MyDivision</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">CN = www.netskill.id</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">[v3_req]</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">keyUsage = keyEncipherment, dataEncipherment</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">extendedKeyUsage = serverAuth</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">subjectAltName = @alt_names</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">[alt_names]</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">DNS.1 = www.netskill.id</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">DNS.2 = netskill.id</span><br /><div><br /></div><div>Untuk membuat file seperti diatas bisa mencopy kemudian mencontoh/mengedit&nbsp; file /etc/ssl/openssl.cnf<br />Kemudian gunakan perintah berikut</div><div><br /></div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">openssl req -new -newkey rsa:2048 -nodes -sha256 -keyout myweb.key -out myweb.csr <b>-config myconfig.cnf</b></span><br /><div><br /></div><div>Cek informasi csr</div><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">openssl req -noout -text -in myweb.csr</span></div><div><br /></div><div>Bisa juga semua pembuatan csr, key dan crt dilakukan di sisi windows menggunakan MMC certificate bisa ikuti tutorial disini</div><div><a href="https://knowledge.digicert.com/solution/SO21586.html">https://knowledge.digicert.com/solution/SO21586.html</a></div><div><br /></div></div><div style="text-align: left;">kemudian CSR ini dikirim ke ADCS melalui web enrollment.</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-iVkCsbEH3IQ/XPERFfRG7AI/AAAAAAAABYw/adtNWMHBFV4nOJLbhCPtp42pDWFhvbQ7QCLcBGAs/s1600/2019-05-31%2B18_33_01-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="300" data-original-width="442" height="271" src="https://1.bp.blogspot.com/-iVkCsbEH3IQ/XPERFfRG7AI/AAAAAAAABYw/adtNWMHBFV4nOJLbhCPtp42pDWFhvbQ7QCLcBGAs/s400/2019-05-31%2B18_33_01-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" width="400" /></a></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-gcr_TjuUDj4/XPERVrsCdwI/AAAAAAAABY4/TtJ_ZIGBmzIe0leo848yZ0w0gj9XSmcJQCLcBGAs/s1600/2019-05-31%2B18_34_05-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="209" data-original-width="447" height="186" src="https://1.bp.blogspot.com/-gcr_TjuUDj4/XPERVrsCdwI/AAAAAAAABY4/TtJ_ZIGBmzIe0leo848yZ0w0gj9XSmcJQCLcBGAs/s400/2019-05-31%2B18_34_05-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-ZGA4oi9nV_I/XPETZlBr90I/AAAAAAAABZE/gRGEUKSvRX4BbNA4jRg3LZXfrdXwkwBdgCLcBGAs/s1600/2019-05-31%2B18_42_57-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="461" data-original-width="444" height="400" src="https://1.bp.blogspot.com/-ZGA4oi9nV_I/XPETZlBr90I/AAAAAAAABZE/gRGEUKSvRX4BbNA4jRg3LZXfrdXwkwBdgCLcBGAs/s400/2019-05-31%2B18_42_57-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" width="385" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-gF9s071O9zU/XPEU2FCv1-I/AAAAAAAABZk/cx1IWUH_ag8HMAhfGt15Y-Z-M8lGuAnbACLcBGAs/s1600/2019-05-31%2B18_24_12-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="184" data-original-width="724" height="81" src="https://1.bp.blogspot.com/-gF9s071O9zU/XPEU2FCv1-I/AAAAAAAABZk/cx1IWUH_ag8HMAhfGt15Y-Z-M8lGuAnbACLcBGAs/s320/2019-05-31%2B18_24_12-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Sd89wXtU5d4/XPEU8IvUNgI/AAAAAAAABZo/EvYG7T4_W9Mq0CkBzstdeNtiw-6pFbWsACLcBGAs/s1600/2019-05-31%2B18_48_55-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="205" data-original-width="434" height="188" src="https://1.bp.blogspot.com/-Sd89wXtU5d4/XPEU8IvUNgI/AAAAAAAABZo/EvYG7T4_W9Mq0CkBzstdeNtiw-6pFbWsACLcBGAs/s400/2019-05-31%2B18_48_55-Microsoft%2BActive%2BDirectory%2BCertificate%2BServices.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Download hasil sertifikat nya dengan extensi cer namun bisa di rename menjadi crt dan siap digunakan di layanan yang akan menggunakan sertifikat.<br /><br /></div>